<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Introduction" href="../main.html" /><link rel="prev" title="Via Native json" href="jsonl.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2024.01.29 -->
        <title>Via Huggingface datasets - Amazon Reviews&#39;23</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=4095e3e2" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Amazon Reviews'23</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/ucsd_logo.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/ucsd_logo.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Amazon Reviews'23</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../data_processing/index.html">Common Data Processing</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Common Data Processing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../data_processing/0core.html">Pure IDs (0-Core)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_processing/5core.html">Pure IDs (5-Core)</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Common Data Loading</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Common Data Loading</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="jsonl.html">Via Native <code class="docutils literal notranslate"><span class="pre">json</span></code></a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Via Huggingface <code class="docutils literal notranslate"><span class="pre">datasets</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../main.html">Back to Home</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="via-huggingface-datasets">
<h1>Via Huggingface <code class="docutils literal notranslate"><span class="pre">datasets</span></code><a class="headerlink" href="#via-huggingface-datasets" title="Permalink to this heading">#</a></h1>
<p>Define a “pretty print” function <code class="docutils literal notranslate"><span class="pre">pprint</span></code> for dict objects and dataframes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span> 
<span class="n">pprint</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="n">display</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Ignore some unnecessary outputs from huggingface datasets</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datasets</span> 
<span class="n">datasets</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">set_verbosity_error</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="load-review-samples">
<h2>Load Review Samples<a class="headerlink" href="#load-review-samples" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;McAuley-Lab/Amazon-Reviews-2023&quot;</span><span class="p">,</span> <span class="s2">&quot;raw_review_All_Beauty&quot;</span><span class="p">,</span> <span class="n">trust_remote_code</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;McAuley-Lab/Amazon-Reviews-2023&quot;</span><span class="p">,</span> <span class="s2">&quot;raw_review_All_Beauty&quot;</span><span class="p">,</span> <span class="n">trust_remote_code</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/dl/lib/python3.9/site-packages/datasets/load.py:2556,</span> in <span class="ni">load_dataset</span><span class="nt">(path, name, data_dir, data_files, split, cache_dir, features, download_config, download_mode, verification_mode, ignore_verifications, keep_in_memory, save_infos, revision, token, use_auth_token, task, streaming, num_proc, storage_options, trust_remote_code, **config_kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2551</span> <span class="n">verification_mode</span> <span class="o">=</span> <span class="n">VerificationMode</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2552</span>     <span class="p">(</span><span class="n">verification_mode</span> <span class="ow">or</span> <span class="n">VerificationMode</span><span class="o">.</span><span class="n">BASIC_CHECKS</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">save_infos</span> <span class="k">else</span> <span class="n">VerificationMode</span><span class="o">.</span><span class="n">ALL_CHECKS</span>
<span class="g g-Whitespace">   </span><span class="mi">2553</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2555</span> <span class="c1"># Create a dataset builder</span>
<span class="ne">-&gt; </span><span class="mi">2556</span> <span class="n">builder_instance</span> <span class="o">=</span> <span class="n">load_dataset_builder</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2557</span>     <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2558</span>     <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2559</span>     <span class="n">data_dir</span><span class="o">=</span><span class="n">data_dir</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2560</span>     <span class="n">data_files</span><span class="o">=</span><span class="n">data_files</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2561</span>     <span class="n">cache_dir</span><span class="o">=</span><span class="n">cache_dir</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2562</span>     <span class="n">features</span><span class="o">=</span><span class="n">features</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2563</span>     <span class="n">download_config</span><span class="o">=</span><span class="n">download_config</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2564</span>     <span class="n">download_mode</span><span class="o">=</span><span class="n">download_mode</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2565</span>     <span class="n">revision</span><span class="o">=</span><span class="n">revision</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2566</span>     <span class="n">token</span><span class="o">=</span><span class="n">token</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2567</span>     <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2568</span>     <span class="n">trust_remote_code</span><span class="o">=</span><span class="n">trust_remote_code</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2569</span>     <span class="n">_require_default_config_name</span><span class="o">=</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2570</span>     <span class="o">**</span><span class="n">config_kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2571</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2573</span> <span class="c1"># Return iterable dataset in case of streaming</span>
<span class="g g-Whitespace">   </span><span class="mi">2574</span> <span class="k">if</span> <span class="n">streaming</span><span class="p">:</span>

<span class="nn">File ~/miniconda3/envs/dl/lib/python3.9/site-packages/datasets/load.py:2228,</span> in <span class="ni">load_dataset_builder</span><span class="nt">(path, name, data_dir, data_files, cache_dir, features, download_config, download_mode, revision, token, use_auth_token, storage_options, trust_remote_code, _require_default_config_name, **config_kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2226</span>     <span class="n">download_config</span> <span class="o">=</span> <span class="n">download_config</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="n">download_config</span> <span class="k">else</span> <span class="n">DownloadConfig</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">2227</span>     <span class="n">download_config</span><span class="o">.</span><span class="n">storage_options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">storage_options</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2228</span> <span class="n">dataset_module</span> <span class="o">=</span> <span class="n">dataset_module_factory</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2229</span>     <span class="n">path</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2230</span>     <span class="n">revision</span><span class="o">=</span><span class="n">revision</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2231</span>     <span class="n">download_config</span><span class="o">=</span><span class="n">download_config</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2232</span>     <span class="n">download_mode</span><span class="o">=</span><span class="n">download_mode</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2233</span>     <span class="n">data_dir</span><span class="o">=</span><span class="n">data_dir</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2234</span>     <span class="n">data_files</span><span class="o">=</span><span class="n">data_files</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2235</span>     <span class="n">cache_dir</span><span class="o">=</span><span class="n">cache_dir</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2236</span>     <span class="n">trust_remote_code</span><span class="o">=</span><span class="n">trust_remote_code</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2237</span>     <span class="n">_require_default_config_name</span><span class="o">=</span><span class="n">_require_default_config_name</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2238</span>     <span class="n">_require_custom_configs</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="n">config_kwargs</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">2239</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2240</span> <span class="c1"># Get dataset builder class from the processing script</span>
<span class="g g-Whitespace">   </span><span class="mi">2241</span> <span class="n">builder_kwargs</span> <span class="o">=</span> <span class="n">dataset_module</span><span class="o">.</span><span class="n">builder_kwargs</span>

<span class="nn">File ~/miniconda3/envs/dl/lib/python3.9/site-packages/datasets/load.py:1839,</span> in <span class="ni">dataset_module_factory</span><span class="nt">(path, revision, download_config, download_mode, dynamic_modules_path, data_dir, data_files, cache_dir, trust_remote_code, _require_default_config_name, _require_custom_configs, **download_kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1834</span> <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">USE_PARQUET_EXPORT</span> <span class="ow">and</span> <span class="n">can_load_config_from_parquet_export</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1835</span>     <span class="c1"># If the parquet export is ready (parquet files + info available for the current sha), we can use it instead</span>
<span class="g g-Whitespace">   </span><span class="mi">1836</span>     <span class="c1"># This fails when the dataset has multiple configs and a default config and</span>
<span class="g g-Whitespace">   </span><span class="mi">1837</span>     <span class="c1"># the user didn&#39;t specify a configuration name (_require_default_config_name=True).</span>
<span class="g g-Whitespace">   </span><span class="mi">1838</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1839</span>         <span class="k">return</span> <span class="n">HubDatasetModuleFactoryWithParquetExport</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1840</span>             <span class="n">path</span><span class="p">,</span> <span class="n">download_config</span><span class="o">=</span><span class="n">download_config</span><span class="p">,</span> <span class="n">revision</span><span class="o">=</span><span class="n">dataset_info</span><span class="o">.</span><span class="n">sha</span>
<span class="g g-Whitespace">   </span><span class="mi">1841</span>         <span class="p">)</span><span class="o">.</span><span class="n">get_module</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1842</span>     <span class="k">except</span> <span class="n">_datasets_server</span><span class="o">.</span><span class="n">DatasetsServerError</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1843</span>         <span class="k">pass</span>

<span class="nn">File ~/miniconda3/envs/dl/lib/python3.9/site-packages/datasets/load.py:1353,</span> in <span class="ni">HubDatasetModuleFactoryWithParquetExport.get_module</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1352</span> <span class="k">def</span> <span class="nf">get_module</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DatasetModule</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1353</span>     <span class="n">exported_parquet_files</span> <span class="o">=</span> <span class="n">_datasets_server</span><span class="o">.</span><span class="n">get_exported_parquet_files</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1354</span>         <span class="n">dataset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">revision</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">revision</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">download_config</span><span class="o">.</span><span class="n">token</span>
<span class="g g-Whitespace">   </span><span class="mi">1355</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1356</span>     <span class="n">exported_dataset_infos</span> <span class="o">=</span> <span class="n">_datasets_server</span><span class="o">.</span><span class="n">get_exported_dataset_infos</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1357</span>         <span class="n">dataset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">revision</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">revision</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">download_config</span><span class="o">.</span><span class="n">token</span>
<span class="g g-Whitespace">   </span><span class="mi">1358</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1359</span>     <span class="n">dataset_infos</span> <span class="o">=</span> <span class="n">DatasetInfosDict</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1360</span>         <span class="p">{</span>
<span class="g g-Whitespace">   </span><span class="mi">1361</span>             <span class="n">config_name</span><span class="p">:</span> <span class="n">DatasetInfo</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">exported_dataset_infos</span><span class="p">[</span><span class="n">config_name</span><span class="p">])</span>
<span class="g g-Whitespace">   </span><span class="mi">1362</span>             <span class="k">for</span> <span class="n">config_name</span> <span class="ow">in</span> <span class="n">exported_dataset_infos</span>
<span class="g g-Whitespace">   </span><span class="mi">1363</span>         <span class="p">}</span>
<span class="g g-Whitespace">   </span><span class="mi">1364</span>     <span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/dl/lib/python3.9/site-packages/datasets/utils/_datasets_server.py:32,</span> in <span class="ni">get_exported_parquet_files</span><span class="nt">(dataset, revision, token)</span>
<span class="g g-Whitespace">     </span><span class="mi">30</span> <span class="n">datasets_server_parquet_url</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">HF_ENDPOINT</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;://&quot;</span><span class="p">,</span> <span class="s2">&quot;://datasets-server.&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/parquet?dataset=&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">31</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">32</span>     <span class="n">parquet_data_files_response</span> <span class="o">=</span> <span class="n">http_get</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">33</span>         <span class="n">url</span><span class="o">=</span><span class="n">datasets_server_parquet_url</span> <span class="o">+</span> <span class="n">dataset</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">34</span>         <span class="n">temp_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">35</span>         <span class="n">headers</span><span class="o">=</span><span class="n">get_authentication_headers_for_url</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">HF_ENDPOINT</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;datasets/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="n">token</span><span class="p">),</span>
<span class="g g-Whitespace">     </span><span class="mi">36</span>         <span class="n">timeout</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">37</span>         <span class="n">max_retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">38</span>     <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">39</span>     <span class="n">parquet_data_files_response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span>     <span class="k">if</span> <span class="s2">&quot;X-Revision&quot;</span> <span class="ow">in</span> <span class="n">parquet_data_files_response</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>

<span class="nn">File ~/miniconda3/envs/dl/lib/python3.9/site-packages/datasets/utils/file_utils.py:382,</span> in <span class="ni">http_get</span><span class="nt">(url, temp_file, proxies, resume_size, headers, cookies, timeout, max_retries, desc)</span>
<span class="g g-Whitespace">    </span><span class="mi">380</span> <span class="k">if</span> <span class="n">resume_size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">381</span>     <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Range&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;bytes=</span><span class="si">{</span><span class="n">resume_size</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2">-&quot;</span>
<span class="ne">--&gt; </span><span class="mi">382</span> <span class="n">response</span> <span class="o">=</span> <span class="n">_request_with_retry</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">383</span>     <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">384</span>     <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">385</span>     <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">386</span>     <span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">387</span>     <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">388</span>     <span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">389</span>     <span class="n">max_retries</span><span class="o">=</span><span class="n">max_retries</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">390</span>     <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">391</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">392</span> <span class="k">if</span> <span class="n">temp_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">393</span>     <span class="k">return</span> <span class="n">response</span>

<span class="nn">File ~/miniconda3/envs/dl/lib/python3.9/site-packages/datasets/utils/file_utils.py:304,</span> in <span class="ni">_request_with_retry</span><span class="nt">(method, url, max_retries, base_wait_time, max_wait_time, timeout, **params)</span>
<span class="g g-Whitespace">    </span><span class="mi">302</span> <span class="n">tries</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="g g-Whitespace">    </span><span class="mi">303</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">304</span>     <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">305</span>     <span class="n">success</span> <span class="o">=</span> <span class="kc">True</span>
<span class="g g-Whitespace">    </span><span class="mi">306</span> <span class="k">except</span> <span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectTimeout</span><span class="p">,</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectionError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>

<span class="nn">File ~/miniconda3/envs/dl/lib/python3.9/site-packages/requests/api.py:59,</span> in <span class="ni">request</span><span class="nt">(method, url, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">55</span> <span class="c1"># By using the &#39;with&#39; statement we are sure the session is closed, thus we</span>
<span class="g g-Whitespace">     </span><span class="mi">56</span> <span class="c1"># avoid leaving sockets open which can trigger a ResourceWarning in some</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span> <span class="c1"># cases, and look like a memory leak in others.</span>
<span class="g g-Whitespace">     </span><span class="mi">58</span> <span class="k">with</span> <span class="n">sessions</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">59</span>     <span class="k">return</span> <span class="n">session</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/dl/lib/python3.9/site-packages/requests/sessions.py:589,</span> in <span class="ni">Session.request</span><span class="nt">(self, method, url, params, data, headers, cookies, files, auth, timeout, allow_redirects, proxies, hooks, stream, verify, cert, json)</span>
<span class="g g-Whitespace">    </span><span class="mi">584</span> <span class="n">send_kwargs</span> <span class="o">=</span> <span class="p">{</span>
<span class="g g-Whitespace">    </span><span class="mi">585</span>     <span class="s2">&quot;timeout&quot;</span><span class="p">:</span> <span class="n">timeout</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">586</span>     <span class="s2">&quot;allow_redirects&quot;</span><span class="p">:</span> <span class="n">allow_redirects</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">587</span> <span class="p">}</span>
<span class="g g-Whitespace">    </span><span class="mi">588</span> <span class="n">send_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">589</span> <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">prep</span><span class="p">,</span> <span class="o">**</span><span class="n">send_kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">591</span> <span class="k">return</span> <span class="n">resp</span>

<span class="nn">File ~/miniconda3/envs/dl/lib/python3.9/site-packages/requests/sessions.py:703,</span> in <span class="ni">Session.send</span><span class="nt">(self, request, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">700</span> <span class="n">start</span> <span class="o">=</span> <span class="n">preferred_clock</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">702</span> <span class="c1"># Send the request</span>
<span class="ne">--&gt; </span><span class="mi">703</span> <span class="n">r</span> <span class="o">=</span> <span class="n">adapter</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">705</span> <span class="c1"># Total elapsed time of the request (approximately)</span>
<span class="g g-Whitespace">    </span><span class="mi">706</span> <span class="n">elapsed</span> <span class="o">=</span> <span class="n">preferred_clock</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="nn">File ~/miniconda3/envs/dl/lib/python3.9/site-packages/requests/adapters.py:486,</span> in <span class="ni">HTTPAdapter.send</span><span class="nt">(self, request, stream, timeout, verify, cert, proxies)</span>
<span class="g g-Whitespace">    </span><span class="mi">483</span>     <span class="n">timeout</span> <span class="o">=</span> <span class="n">TimeoutSauce</span><span class="p">(</span><span class="n">connect</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span> <span class="n">read</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">485</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">486</span>     <span class="n">resp</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">487</span>         <span class="n">method</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">488</span>         <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">489</span>         <span class="n">body</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">490</span>         <span class="n">headers</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">491</span>         <span class="n">redirect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">492</span>         <span class="n">assert_same_host</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">493</span>         <span class="n">preload_content</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">494</span>         <span class="n">decode_content</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">495</span>         <span class="n">retries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_retries</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">496</span>         <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">497</span>         <span class="n">chunked</span><span class="o">=</span><span class="n">chunked</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">498</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">500</span> <span class="k">except</span> <span class="p">(</span><span class="n">ProtocolError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">501</span>     <span class="k">raise</span> <span class="ne">ConnectionError</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/dl/lib/python3.9/site-packages/urllib3/connectionpool.py:793,</span> in <span class="ni">HTTPConnectionPool.urlopen</span><span class="nt">(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, preload_content, decode_content, **response_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">790</span> <span class="n">response_conn</span> <span class="o">=</span> <span class="n">conn</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">release_conn</span> <span class="k">else</span> <span class="kc">None</span>
<span class="g g-Whitespace">    </span><span class="mi">792</span> <span class="c1"># Make the request on the HTTPConnection object</span>
<span class="ne">--&gt; </span><span class="mi">793</span> <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_request</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">794</span>     <span class="n">conn</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">795</span>     <span class="n">method</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">796</span>     <span class="n">url</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">797</span>     <span class="n">timeout</span><span class="o">=</span><span class="n">timeout_obj</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">798</span>     <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">799</span>     <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">800</span>     <span class="n">chunked</span><span class="o">=</span><span class="n">chunked</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">801</span>     <span class="n">retries</span><span class="o">=</span><span class="n">retries</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">802</span>     <span class="n">response_conn</span><span class="o">=</span><span class="n">response_conn</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">803</span>     <span class="n">preload_content</span><span class="o">=</span><span class="n">preload_content</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">804</span>     <span class="n">decode_content</span><span class="o">=</span><span class="n">decode_content</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">805</span>     <span class="o">**</span><span class="n">response_kw</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">806</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">808</span> <span class="c1"># Everything went great!</span>
<span class="g g-Whitespace">    </span><span class="mi">809</span> <span class="n">clean_exit</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nn">File ~/miniconda3/envs/dl/lib/python3.9/site-packages/urllib3/connectionpool.py:537,</span> in <span class="ni">HTTPConnectionPool._make_request</span><span class="nt">(self, conn, method, url, body, headers, retries, timeout, chunked, response_conn, preload_content, decode_content, enforce_content_length)</span>
<span class="g g-Whitespace">    </span><span class="mi">535</span> <span class="c1"># Receive the response from the server</span>
<span class="g g-Whitespace">    </span><span class="mi">536</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">537</span>     <span class="n">response</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">getresponse</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">538</span> <span class="k">except</span> <span class="p">(</span><span class="n">BaseSSLError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">539</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_raise_timeout</span><span class="p">(</span><span class="n">err</span><span class="o">=</span><span class="n">e</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout_value</span><span class="o">=</span><span class="n">read_timeout</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/dl/lib/python3.9/site-packages/urllib3/connection.py:466,</span> in <span class="ni">HTTPConnection.getresponse</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">463</span> <span class="kn">from</span> <span class="nn">.response</span> <span class="kn">import</span> <span class="n">HTTPResponse</span>
<span class="g g-Whitespace">    </span><span class="mi">465</span> <span class="c1"># Get the response from http.client.HTTPConnection</span>
<span class="ne">--&gt; </span><span class="mi">466</span> <span class="n">httplib_response</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">getresponse</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">468</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">469</span>     <span class="n">assert_header_parsing</span><span class="p">(</span><span class="n">httplib_response</span><span class="o">.</span><span class="n">msg</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/dl/lib/python3.9/http/client.py:1377,</span> in <span class="ni">HTTPConnection.getresponse</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1375</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1376</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1377</span>         <span class="n">response</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1378</span>     <span class="k">except</span> <span class="ne">ConnectionError</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1379</span>         <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="nn">File ~/miniconda3/envs/dl/lib/python3.9/http/client.py:320,</span> in <span class="ni">HTTPResponse.begin</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">318</span> <span class="c1"># read until we get a non-100 response</span>
<span class="g g-Whitespace">    </span><span class="mi">319</span> <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">320</span>     <span class="n">version</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">reason</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_status</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">321</span>     <span class="k">if</span> <span class="n">status</span> <span class="o">!=</span> <span class="n">CONTINUE</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">322</span>         <span class="k">break</span>

<span class="nn">File ~/miniconda3/envs/dl/lib/python3.9/http/client.py:281,</span> in <span class="ni">HTTPResponse._read_status</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">280</span> <span class="k">def</span> <span class="nf">_read_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">281</span>     <span class="n">line</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">readline</span><span class="p">(</span><span class="n">_MAXLINE</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;iso-8859-1&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">282</span>     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">_MAXLINE</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">283</span>         <span class="k">raise</span> <span class="n">LineTooLong</span><span class="p">(</span><span class="s2">&quot;status line&quot;</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/dl/lib/python3.9/socket.py:704,</span> in <span class="ni">SocketIO.readinto</span><span class="nt">(self, b)</span>
<span class="g g-Whitespace">    </span><span class="mi">702</span> <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">703</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">704</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sock</span><span class="o">.</span><span class="n">recv_into</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">705</span>     <span class="k">except</span> <span class="n">timeout</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">706</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_timeout_occurred</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nn">File ~/miniconda3/envs/dl/lib/python3.9/ssl.py:1275,</span> in <span class="ni">SSLSocket.recv_into</span><span class="nt">(self, buffer, nbytes, flags)</span>
<span class="g g-Whitespace">   </span><span class="mi">1271</span>     <span class="k">if</span> <span class="n">flags</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1272</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1273</span>           <span class="s2">&quot;non-zero flags not allowed in calls to recv_into() on </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span>
<span class="g g-Whitespace">   </span><span class="mi">1274</span>           <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1275</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">nbytes</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1276</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1277</span>     <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">recv_into</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/dl/lib/python3.9/ssl.py:1133,</span> in <span class="ni">SSLSocket.read</span><span class="nt">(self, len, buffer)</span>
<span class="g g-Whitespace">   </span><span class="mi">1131</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1132</span>     <span class="k">if</span> <span class="n">buffer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1133</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sslobj</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1134</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1135</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sslobj</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;full&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;rating&#39;: 5.0,
 &#39;title&#39;: &#39;Such a lovely scent but not overpowering.&#39;,
 &#39;text&#39;: &quot;This spray is really nice. It smells really good, goes on really fine, and does the trick. I will say it feels like you need a lot of it though to get the texture I want. I have a lot of hair, medium thickness. I am comparing to other brands with yucky chemicals so I&#39;m gonna stick with this. Try it!&quot;,
 &#39;images&#39;: [],
 &#39;asin&#39;: &#39;B00YQ6X8EO&#39;,
 &#39;parent_asin&#39;: &#39;B00YQ6X8EO&#39;,
 &#39;user_id&#39;: &#39;AGKHLEW2SOWHNMFQIJGBECAF7INQ&#39;,
 &#39;timestamp&#39;: 1588687728923,
 &#39;helpful_vote&#39;: 0,
 &#39;verified_purchase&#39;: True}
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-item-metadata">
<h2>Load Item Metadata<a class="headerlink" href="#load-item-metadata" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;McAuley-Lab/Amazon-Reviews-2023&quot;</span><span class="p">,</span> <span class="s2">&quot;raw_meta_All_Beauty&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;full&quot;</span><span class="p">,</span> <span class="n">trust_remote_code</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/yuh125/miniconda3/envs/dl/lib/python3.9/site-packages/datasets/load.py:1461: FutureWarning: The repository for McAuley-Lab/Amazon-Reviews-2023 contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/McAuley-Lab/Amazon-Reviews-2023
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
Downloading data: 100%|██████████| 213M/213M [00:19&lt;00:00, 11.0MB/s] 
Generating full split: 112590 examples [00:08, 13095.48 examples/s]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;main_category&#39;: &#39;All Beauty&#39;,
 &#39;title&#39;: &#39;Howard LC0008 Leather Conditioner, 8-Ounce (4-Pack)&#39;,
 &#39;average_rating&#39;: 4.8,
 &#39;rating_number&#39;: 10,
 &#39;features&#39;: [],
 &#39;description&#39;: [],
 &#39;price&#39;: &#39;None&#39;,
 &#39;images&#39;: {&#39;hi_res&#39;: [None,
   &#39;https://m.media-amazon.com/images/I/71i77AuI9xL._SL1500_.jpg&#39;],
  &#39;large&#39;: [&#39;https://m.media-amazon.com/images/I/41qfjSfqNyL.jpg&#39;,
   &#39;https://m.media-amazon.com/images/I/41w2yznfuZL.jpg&#39;],
  &#39;thumb&#39;: [&#39;https://m.media-amazon.com/images/I/41qfjSfqNyL._SS40_.jpg&#39;,
   &#39;https://m.media-amazon.com/images/I/41w2yznfuZL._SS40_.jpg&#39;],
  &#39;variant&#39;: [&#39;MAIN&#39;, &#39;PT01&#39;]},
 &#39;videos&#39;: {&#39;title&#39;: [], &#39;url&#39;: [], &#39;user_id&#39;: []},
 &#39;store&#39;: &#39;Howard Products&#39;,
 &#39;categories&#39;: [],
 &#39;details&#39;: &#39;{&quot;Package Dimensions&quot;: &quot;7.1 x 5.5 x 3 inches; 2.38 Pounds&quot;, &quot;UPC&quot;: &quot;617390882781&quot;}&#39;,
 &#39;parent_asin&#39;: &#39;B01CUPMQZE&#39;,
 &#39;bought_together&#39;: None,
 &#39;subtitle&#39;: None,
 &#39;author&#39;: None}
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-pure-ids-files-before-splitting">
<h2>Load Pure IDs Files (Before Splitting)<a class="headerlink" href="#load-pure-ids-files-before-splitting" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;McAuley-Lab/Amazon-Reviews-2023&quot;</span><span class="p">,</span> <span class="s2">&quot;0core_rating_only_All_Beauty&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading data: 100%|██████████| 40.2M/40.2M [00:02&lt;00:00, 13.9MB/s]
Generating full split: 693929 examples [00:01, 361944.68 examples/s]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;full&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{
  &quot;user_id&quot;: [
    &quot;AGKHLEW2SOWHNMFQIJGBECAF7INQ&quot;,
    &quot;AGKHLEW2SOWHNMFQIJGBECAF7INQ&quot;,
    &quot;AE74DYR3QUGVPZJ3P7RFWBGIX7XQ&quot;,
    &quot;AFQLNQNQYFWQZPJQZS6V3NZU4QBQ&quot;,
    &quot;AFQLNQNQYFWQZPJQZS6V3NZU4QBQ&quot;
  ],
  &quot;parent_asin&quot;: [
    &quot;B081TJ8YS3&quot;,
    &quot;B00YQ6X8EO&quot;,
    &quot;B097R46CSY&quot;,
    &quot;B08BZ63GMJ&quot;,
    &quot;B09JS339BZ&quot;
  ],
  &quot;rating&quot;: [
    &quot;4.0&quot;,
    &quot;5.0&quot;,
    &quot;5.0&quot;,
    &quot;5.0&quot;,
    &quot;1.0&quot;
  ],
  &quot;timestamp&quot;: [
    &quot;1588615855070&quot;,
    &quot;1588687728923&quot;,
    &quot;1589665266052&quot;,
    &quot;1609322563534&quot;,
    &quot;1643393630220&quot;
  ]
}
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-pure-ids-files-after-splitting">
<h2>Load Pure IDs Files (After Splitting)<a class="headerlink" href="#load-pure-ids-files-after-splitting" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;McAuley-Lab/Amazon-Reviews-2023&quot;</span><span class="p">,</span> <span class="s2">&quot;0core_timestamp_All_Beauty&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading data: 100%|██████████| 33.8M/33.8M [00:02&lt;00:00, 15.4MB/s]
Downloading data: 100%|██████████| 4.16M/4.16M [00:00&lt;00:00, 14.6MB/s]
Downloading data: 100%|██████████| 2.26M/2.26M [00:00&lt;00:00, 13.4MB/s]
Generating train split: 583190 examples [00:01, 355294.29 examples/s]
Generating valid split: 71784 examples [00:00, 93691.27 examples/s]
Generating test split: 38955 examples [00:00, 93479.84 examples/s]
</pre></div>
</div>
</div>
</div>
<section id="only-need-user-item-interactions">
<h3>Only need (user, item) interactions:<a class="headerlink" href="#only-need-user-item-interactions" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">][:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;user_id&#39;: [&#39;AGKHLEW2SOWHNMFQIJGBECAF7INQ&#39;,
  &#39;AGKHLEW2SOWHNMFQIJGBECAF7INQ&#39;,
  &#39;AE74DYR3QUGVPZJ3P7RFWBGIX7XQ&#39;,
  &#39;AFQLNQNQYFWQZPJQZS6V3NZU4QBQ&#39;,
  &#39;AGMJ3EMDVL6OWBJF7CA5RGJLXN5A&#39;],
 &#39;parent_asin&#39;: [&#39;B081TJ8YS3&#39;,
  &#39;B00YQ6X8EO&#39;,
  &#39;B097R46CSY&#39;,
  &#39;B08BZ63GMJ&#39;,
  &#39;B00R8DXL44&#39;],
 &#39;rating&#39;: [&#39;4.0&#39;, &#39;5.0&#39;, &#39;5.0&#39;, &#39;5.0&#39;, &#39;4.0&#39;],
 &#39;timestamp&#39;: [&#39;1588615855070&#39;,
  &#39;1588687728923&#39;,
  &#39;1589665266052&#39;,
  &#39;1609322563534&#39;,
  &#39;1598567408138&#39;]}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;valid&#39;</span><span class="p">][:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;user_id&#39;: [&#39;AFQLNQNQYFWQZPJQZS6V3NZU4QBQ&#39;,
  &#39;AHREXOGQPZDA6354MHH4ETSF3MCQ&#39;,
  &#39;AEYORY2AVPMCPDV57CE337YU5LXA&#39;,
  &#39;AFETVW7S5M4LVJ7GTWPCKT7S3YBQ&#39;,
  &#39;AGVVUU3QRQBHNASSGI5YQLPYOI2Q&#39;],
 &#39;parent_asin&#39;: [&#39;B09JS339BZ&#39;,
  &#39;B099DRHW5V&#39;,
  &#39;B08BBQ29N5&#39;,
  &#39;B01M5KNSQN&#39;,
  &#39;B09FF97RHL&#39;],
 &#39;rating&#39;: [&#39;1.0&#39;, &#39;5.0&#39;, &#39;3.0&#39;, &#39;1.0&#39;, &#39;1.0&#39;],
 &#39;timestamp&#39;: [&#39;1643393630220&#39;,
  &#39;1631885519443&#39;,
  &#39;1634275259292&#39;,
  &#39;1649634131604&#39;,
  &#39;1648824907536&#39;]}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">][:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;user_id&#39;: [&#39;AFZUK3MTBIBEDQOPAK3OATUOUKLA&#39;,
  &#39;AHV6QCNBJNSGLATP56JAWJ3C4G2A&#39;,
  &#39;AHV6QCNBJNSGLATP56JAWJ3C4G2A&#39;,
  &#39;AHV6QCNBJNSGLATP56JAWJ3C4G2A&#39;,
  &#39;AEZ26WGWJ3EOQ4KWSHG77HJAG4EA&#39;],
 &#39;parent_asin&#39;: [&#39;B0BFR5WF1R&#39;,
  &#39;B0B4JPGX8P&#39;,
  &#39;B0B4JP5YD9&#39;,
  &#39;B0B8DZ7H5F&#39;,
  &#39;B0B7RBK4NJ&#39;],
 &#39;rating&#39;: [&#39;1.0&#39;, &#39;4.0&#39;, &#39;5.0&#39;, &#39;4.0&#39;, &#39;1.0&#39;],
 &#39;timestamp&#39;: [&#39;1675826333052&#39;,
  &#39;1660417672640&#39;,
  &#39;1660417831321&#39;,
  &#39;1663163956007&#39;,
  &#39;1662827578220&#39;]}
</pre></div>
</div>
</div>
</div>
</section>
<section id="need-additional-user-historical-interactions">
<h3>Need additional user historical interactions:<a class="headerlink" href="#need-additional-user-historical-interactions" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;McAuley-Lab/Amazon-Reviews-2023&quot;</span><span class="p">,</span> <span class="s2">&quot;0core_timestamp_w_his_All_Beauty&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading data: 100%|██████████| 35.9M/35.9M [00:02&lt;00:00, 15.2MB/s]
Downloading data: 100%|██████████| 4.71M/4.71M [00:00&lt;00:00, 14.8MB/s]
Downloading data: 100%|██████████| 2.48M/2.48M [00:00&lt;00:00, 14.1MB/s]
Generating train split: 583190 examples [00:01, 327193.87 examples/s]
Generating valid split: 71784 examples [00:00, 78271.52 examples/s]
Generating test split: 38955 examples [00:00, 76866.93 examples/s]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">][:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;user_id&#39;: [&#39;AGKHLEW2SOWHNMFQIJGBECAF7INQ&#39;,
  &#39;AGKHLEW2SOWHNMFQIJGBECAF7INQ&#39;,
  &#39;AE74DYR3QUGVPZJ3P7RFWBGIX7XQ&#39;,
  &#39;AFQLNQNQYFWQZPJQZS6V3NZU4QBQ&#39;,
  &#39;AGMJ3EMDVL6OWBJF7CA5RGJLXN5A&#39;],
 &#39;parent_asin&#39;: [&#39;B081TJ8YS3&#39;,
  &#39;B00YQ6X8EO&#39;,
  &#39;B097R46CSY&#39;,
  &#39;B08BZ63GMJ&#39;,
  &#39;B00R8DXL44&#39;],
 &#39;rating&#39;: [&#39;4.0&#39;, &#39;5.0&#39;, &#39;5.0&#39;, &#39;5.0&#39;, &#39;4.0&#39;],
 &#39;timestamp&#39;: [&#39;1588615855070&#39;,
  &#39;1588687728923&#39;,
  &#39;1589665266052&#39;,
  &#39;1609322563534&#39;,
  &#39;1598567408138&#39;],
 &#39;history&#39;: [&#39;&#39;, &#39;B081TJ8YS3&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;valid&#39;</span><span class="p">][:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;user_id&#39;: [&#39;AFQLNQNQYFWQZPJQZS6V3NZU4QBQ&#39;,
  &#39;AHREXOGQPZDA6354MHH4ETSF3MCQ&#39;,
  &#39;AEYORY2AVPMCPDV57CE337YU5LXA&#39;,
  &#39;AFETVW7S5M4LVJ7GTWPCKT7S3YBQ&#39;,
  &#39;AGVVUU3QRQBHNASSGI5YQLPYOI2Q&#39;],
 &#39;parent_asin&#39;: [&#39;B09JS339BZ&#39;,
  &#39;B099DRHW5V&#39;,
  &#39;B08BBQ29N5&#39;,
  &#39;B01M5KNSQN&#39;,
  &#39;B09FF97RHL&#39;],
 &#39;rating&#39;: [&#39;1.0&#39;, &#39;5.0&#39;, &#39;3.0&#39;, &#39;1.0&#39;, &#39;1.0&#39;],
 &#39;timestamp&#39;: [&#39;1643393630220&#39;,
  &#39;1631885519443&#39;,
  &#39;1634275259292&#39;,
  &#39;1649634131604&#39;,
  &#39;1648824907536&#39;],
 &#39;history&#39;: [&#39;B08BZ63GMJ&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">][:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;user_id&#39;: [&#39;AFZUK3MTBIBEDQOPAK3OATUOUKLA&#39;,
  &#39;AHV6QCNBJNSGLATP56JAWJ3C4G2A&#39;,
  &#39;AHV6QCNBJNSGLATP56JAWJ3C4G2A&#39;,
  &#39;AHV6QCNBJNSGLATP56JAWJ3C4G2A&#39;,
  &#39;AEZ26WGWJ3EOQ4KWSHG77HJAG4EA&#39;],
 &#39;parent_asin&#39;: [&#39;B0BFR5WF1R&#39;,
  &#39;B0B4JPGX8P&#39;,
  &#39;B0B4JP5YD9&#39;,
  &#39;B0B8DZ7H5F&#39;,
  &#39;B0B7RBK4NJ&#39;],
 &#39;rating&#39;: [&#39;1.0&#39;, &#39;4.0&#39;, &#39;5.0&#39;, &#39;4.0&#39;, &#39;1.0&#39;],
 &#39;timestamp&#39;: [&#39;1675826333052&#39;,
  &#39;1660417672640&#39;,
  &#39;1660417831321&#39;,
  &#39;1663163956007&#39;,
  &#39;1662827578220&#39;],
 &#39;history&#39;: [&#39;B0020MKBNW B082FLP15V B00946HGLW&#39;,
  &#39;B00N6WHTRG B00NNKWDI6 B00MDKICPK B010B0S67C B00KXFD75M B015ZXMSFQ B00KR4AFJU B01CO73OIQ B00GUTPV4A B01B6V11UY B01KJPFO9W B071R2QPF3 B07GDQPG12 B07KV31WDS B07FZ5HZLM B077YR3333 B07N45YN6C B07J2QZBTP B07NPWK167 B082MTTFZD B07JDD2L3M B07SW7D6ZR B07WNBZQGT B084D86YL8 B082NKQ4ZT B083TLNBJJ B07PRDZ2BH B087D7MVHB B088FBNQXW B085WTCBLG B085NYYLQ8 B08BZ1RHPS B08FRQGYDF B0B2L218H2 B08HXQ3T9K B08KWN77LW B08KYLTK5H B0BTJ6SYKB B07W6H8CGT B08PQ6YXSH B07KQ32Z8C B09KT4RJG6&#39;,
  &#39;B00N6WHTRG B00NNKWDI6 B00MDKICPK B010B0S67C B00KXFD75M B015ZXMSFQ B00KR4AFJU B01CO73OIQ B00GUTPV4A B01B6V11UY B01KJPFO9W B071R2QPF3 B07GDQPG12 B07KV31WDS B07FZ5HZLM B077YR3333 B07N45YN6C B07J2QZBTP B07NPWK167 B082MTTFZD B07JDD2L3M B07SW7D6ZR B07WNBZQGT B084D86YL8 B082NKQ4ZT B083TLNBJJ B07PRDZ2BH B087D7MVHB B088FBNQXW B085WTCBLG B085NYYLQ8 B08BZ1RHPS B08FRQGYDF B0B2L218H2 B08HXQ3T9K B08KWN77LW B08KYLTK5H B0BTJ6SYKB B07W6H8CGT B08PQ6YXSH B07KQ32Z8C B09KT4RJG6 B0B4JPGX8P&#39;,
  &#39;B00N6WHTRG B00NNKWDI6 B00MDKICPK B010B0S67C B00KXFD75M B015ZXMSFQ B00KR4AFJU B01CO73OIQ B00GUTPV4A B01B6V11UY B01KJPFO9W B071R2QPF3 B07GDQPG12 B07KV31WDS B07FZ5HZLM B077YR3333 B07N45YN6C B07J2QZBTP B07NPWK167 B082MTTFZD B07JDD2L3M B07SW7D6ZR B07WNBZQGT B084D86YL8 B082NKQ4ZT B083TLNBJJ B07PRDZ2BH B087D7MVHB B088FBNQXW B085WTCBLG B085NYYLQ8 B08BZ1RHPS B08FRQGYDF B0B2L218H2 B08HXQ3T9K B08KWN77LW B08KYLTK5H B0BTJ6SYKB B07W6H8CGT B08PQ6YXSH B07KQ32Z8C B09KT4RJG6 B0B4JPGX8P B0B4JP5YD9&#39;,
  &#39;&#39;]}
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../main.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Introduction</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="jsonl.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Via Native <code class="docutils literal notranslate"><span class="pre">json</span></code></div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, McAuley Lab
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Via Huggingface <code class="docutils literal notranslate"><span class="pre">datasets</span></code></a><ul>
<li><a class="reference internal" href="#load-review-samples">Load Review Samples</a></li>
<li><a class="reference internal" href="#load-item-metadata">Load Item Metadata</a></li>
<li><a class="reference internal" href="#load-pure-ids-files-before-splitting">Load Pure IDs Files (Before Splitting)</a></li>
<li><a class="reference internal" href="#load-pure-ids-files-after-splitting">Load Pure IDs Files (After Splitting)</a><ul>
<li><a class="reference internal" href="#only-need-user-item-interactions">Only need (user, item) interactions:</a></li>
<li><a class="reference internal" href="#need-additional-user-historical-interactions">Need additional user historical interactions:</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=0ec76b63"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    </body>
</html>