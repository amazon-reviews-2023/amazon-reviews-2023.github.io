{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Via Native `json`"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Define a \"pretty print\" function `pprint` for dict objects and dataframes."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import json \n",
    "pprint = lambda x: print(json.dumps(x, indent=2)) if isinstance(x, dict) else display(x)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Load Review Samples　　"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "file = \"review_categories/All_Beauty.jsonl\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{\n",
      "  \"rating\": 5.0,\n",
      "  \"title\": \"Such a lovely scent but not overpowering.\",\n",
      "  \"text\": \"This spray is really nice. It smells really good, goes on really fine, and does the trick. I will say it feels like you need a lot of it though to get the texture I want. I have a lot of hair, medium thickness. I am comparing to other brands with yucky chemicals so I'm gonna stick with this. Try it!\",\n",
      "  \"images\": [],\n",
      "  \"asin\": \"B00YQ6X8EO\",\n",
      "  \"parent_asin\": \"B00YQ6X8EO\",\n",
      "  \"user_id\": \"AGKHLEW2SOWHNMFQIJGBECAF7INQ\",\n",
      "  \"timestamp\": 1588687728923,\n",
      "  \"helpful_vote\": 0,\n",
      "  \"verified_purchase\": true\n",
      "}\n"
     ]
    }
   ],
   "source": [
    "with open(file, 'r') as fp:\n",
    "    for line in fp:\n",
    "        pprint(json.loads(line.strip()))\n",
    "        break"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Load Item Metadata"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "file = \"meta_categories/meta_All_Beauty.jsonl\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{\n",
      "  \"main_category\": \"All Beauty\",\n",
      "  \"title\": \"Howard LC0008 Leather Conditioner, 8-Ounce (4-Pack)\",\n",
      "  \"average_rating\": 4.8,\n",
      "  \"rating_number\": 10,\n",
      "  \"features\": [],\n",
      "  \"description\": [],\n",
      "  \"price\": null,\n",
      "  \"images\": [\n",
      "    {\n",
      "      \"thumb\": \"https://m.media-amazon.com/images/I/41qfjSfqNyL._SS40_.jpg\",\n",
      "      \"large\": \"https://m.media-amazon.com/images/I/41qfjSfqNyL.jpg\",\n",
      "      \"variant\": \"MAIN\",\n",
      "      \"hi_res\": null\n",
      "    },\n",
      "    {\n",
      "      \"thumb\": \"https://m.media-amazon.com/images/I/41w2yznfuZL._SS40_.jpg\",\n",
      "      \"large\": \"https://m.media-amazon.com/images/I/41w2yznfuZL.jpg\",\n",
      "      \"variant\": \"PT01\",\n",
      "      \"hi_res\": \"https://m.media-amazon.com/images/I/71i77AuI9xL._SL1500_.jpg\"\n",
      "    }\n",
      "  ],\n",
      "  \"videos\": [],\n",
      "  \"store\": \"Howard Products\",\n",
      "  \"categories\": [],\n",
      "  \"details\": {\n",
      "    \"Package Dimensions\": \"7.1 x 5.5 x 3 inches; 2.38 Pounds\",\n",
      "    \"UPC\": \"617390882781\"\n",
      "  },\n",
      "  \"parent_asin\": \"B01CUPMQZE\",\n",
      "  \"bought_together\": null\n",
      "}\n"
     ]
    }
   ],
   "source": [
    "with open(file, 'r') as fp:\n",
    "    for line in fp:\n",
    "        pprint(json.loads(line.strip()))\n",
    "        break"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Load Pure IDs Files (Before Splitting)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "file = \"rating_only/All_Beauty.csv\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>parent_asin</th>\n",
       "      <th>rating</th>\n",
       "      <th>timestamp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AGKHLEW2SOWHNMFQIJGBECAF7INQ</td>\n",
       "      <td>B081TJ8YS3</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1588615855070</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AGKHLEW2SOWHNMFQIJGBECAF7INQ</td>\n",
       "      <td>B00YQ6X8EO</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1588687728923</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AE74DYR3QUGVPZJ3P7RFWBGIX7XQ</td>\n",
       "      <td>B097R46CSY</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1589665266052</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AFQLNQNQYFWQZPJQZS6V3NZU4QBQ</td>\n",
       "      <td>B08BZ63GMJ</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1609322563534</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AFQLNQNQYFWQZPJQZS6V3NZU4QBQ</td>\n",
       "      <td>B09JS339BZ</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1643393630220</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                        user_id parent_asin  rating      timestamp\n",
       "0  AGKHLEW2SOWHNMFQIJGBECAF7INQ  B081TJ8YS3     4.0  1588615855070\n",
       "1  AGKHLEW2SOWHNMFQIJGBECAF7INQ  B00YQ6X8EO     5.0  1588687728923\n",
       "2  AE74DYR3QUGVPZJ3P7RFWBGIX7XQ  B097R46CSY     5.0  1589665266052\n",
       "3  AFQLNQNQYFWQZPJQZS6V3NZU4QBQ  B08BZ63GMJ     5.0  1609322563534\n",
       "4  AFQLNQNQYFWQZPJQZS6V3NZU4QBQ  B09JS339BZ     1.0  1643393630220"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "df = pd.read_csv(file)\n",
    "pprint(df.head())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Load Pure IDs Files (After Splitting)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "file = \"timestamp_split/All_Beauty.{}.csv\""
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Only need (user, item) interactions:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'split: train'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>parent_asin</th>\n",
       "      <th>rating</th>\n",
       "      <th>timestamp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AGKHLEW2SOWHNMFQIJGBECAF7INQ</td>\n",
       "      <td>B081TJ8YS3</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1588615855070</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AGKHLEW2SOWHNMFQIJGBECAF7INQ</td>\n",
       "      <td>B00YQ6X8EO</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1588687728923</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AE74DYR3QUGVPZJ3P7RFWBGIX7XQ</td>\n",
       "      <td>B097R46CSY</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1589665266052</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AFQLNQNQYFWQZPJQZS6V3NZU4QBQ</td>\n",
       "      <td>B08BZ63GMJ</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1609322563534</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AGMJ3EMDVL6OWBJF7CA5RGJLXN5A</td>\n",
       "      <td>B00R8DXL44</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1598567408138</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                        user_id parent_asin  rating      timestamp\n",
       "0  AGKHLEW2SOWHNMFQIJGBECAF7INQ  B081TJ8YS3     4.0  1588615855070\n",
       "1  AGKHLEW2SOWHNMFQIJGBECAF7INQ  B00YQ6X8EO     5.0  1588687728923\n",
       "2  AE74DYR3QUGVPZJ3P7RFWBGIX7XQ  B097R46CSY     5.0  1589665266052\n",
       "3  AFQLNQNQYFWQZPJQZS6V3NZU4QBQ  B08BZ63GMJ     5.0  1609322563534\n",
       "4  AGMJ3EMDVL6OWBJF7CA5RGJLXN5A  B00R8DXL44     4.0  1598567408138"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "'split: valid'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>parent_asin</th>\n",
       "      <th>rating</th>\n",
       "      <th>timestamp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AFQLNQNQYFWQZPJQZS6V3NZU4QBQ</td>\n",
       "      <td>B09JS339BZ</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1643393630220</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AHREXOGQPZDA6354MHH4ETSF3MCQ</td>\n",
       "      <td>B099DRHW5V</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1631885519443</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AEYORY2AVPMCPDV57CE337YU5LXA</td>\n",
       "      <td>B08BBQ29N5</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1634275259292</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AFETVW7S5M4LVJ7GTWPCKT7S3YBQ</td>\n",
       "      <td>B01M5KNSQN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1649634131604</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AGVVUU3QRQBHNASSGI5YQLPYOI2Q</td>\n",
       "      <td>B09FF97RHL</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1648824907536</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                        user_id parent_asin  rating      timestamp\n",
       "0  AFQLNQNQYFWQZPJQZS6V3NZU4QBQ  B09JS339BZ     1.0  1643393630220\n",
       "1  AHREXOGQPZDA6354MHH4ETSF3MCQ  B099DRHW5V     5.0  1631885519443\n",
       "2  AEYORY2AVPMCPDV57CE337YU5LXA  B08BBQ29N5     3.0  1634275259292\n",
       "3  AFETVW7S5M4LVJ7GTWPCKT7S3YBQ  B01M5KNSQN     1.0  1649634131604\n",
       "4  AGVVUU3QRQBHNASSGI5YQLPYOI2Q  B09FF97RHL     1.0  1648824907536"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "'split: test'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>parent_asin</th>\n",
       "      <th>rating</th>\n",
       "      <th>timestamp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AFZUK3MTBIBEDQOPAK3OATUOUKLA</td>\n",
       "      <td>B0BFR5WF1R</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1675826333052</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AHV6QCNBJNSGLATP56JAWJ3C4G2A</td>\n",
       "      <td>B0B4JPGX8P</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1660417672640</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AHV6QCNBJNSGLATP56JAWJ3C4G2A</td>\n",
       "      <td>B0B4JP5YD9</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1660417831321</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AHV6QCNBJNSGLATP56JAWJ3C4G2A</td>\n",
       "      <td>B0B8DZ7H5F</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1663163956007</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AEZ26WGWJ3EOQ4KWSHG77HJAG4EA</td>\n",
       "      <td>B0B7RBK4NJ</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1662827578220</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                        user_id parent_asin  rating      timestamp\n",
       "0  AFZUK3MTBIBEDQOPAK3OATUOUKLA  B0BFR5WF1R     1.0  1675826333052\n",
       "1  AHV6QCNBJNSGLATP56JAWJ3C4G2A  B0B4JPGX8P     4.0  1660417672640\n",
       "2  AHV6QCNBJNSGLATP56JAWJ3C4G2A  B0B4JP5YD9     5.0  1660417831321\n",
       "3  AHV6QCNBJNSGLATP56JAWJ3C4G2A  B0B8DZ7H5F     4.0  1663163956007\n",
       "4  AEZ26WGWJ3EOQ4KWSHG77HJAG4EA  B0B7RBK4NJ     1.0  1662827578220"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "for split in ['train', 'valid', 'test']:\n",
    "    df = pd.read_csv(\n",
    "        file.format(split), \n",
    "        usecols=[0,1,2,3],\n",
    "    )\n",
    "    pprint(f\"split: {split}\")\n",
    "    pprint(df.head())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Need additional user historical interactions:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'split: train'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>parent_asin</th>\n",
       "      <th>rating</th>\n",
       "      <th>timestamp</th>\n",
       "      <th>history</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AGKHLEW2SOWHNMFQIJGBECAF7INQ</td>\n",
       "      <td>B081TJ8YS3</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1588615855070</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AGKHLEW2SOWHNMFQIJGBECAF7INQ</td>\n",
       "      <td>B00YQ6X8EO</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1588687728923</td>\n",
       "      <td>B081TJ8YS3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AE74DYR3QUGVPZJ3P7RFWBGIX7XQ</td>\n",
       "      <td>B097R46CSY</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1589665266052</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AFQLNQNQYFWQZPJQZS6V3NZU4QBQ</td>\n",
       "      <td>B08BZ63GMJ</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1609322563534</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AGMJ3EMDVL6OWBJF7CA5RGJLXN5A</td>\n",
       "      <td>B00R8DXL44</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1598567408138</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                        user_id parent_asin  rating      timestamp     history\n",
       "0  AGKHLEW2SOWHNMFQIJGBECAF7INQ  B081TJ8YS3     4.0  1588615855070         NaN\n",
       "1  AGKHLEW2SOWHNMFQIJGBECAF7INQ  B00YQ6X8EO     5.0  1588687728923  B081TJ8YS3\n",
       "2  AE74DYR3QUGVPZJ3P7RFWBGIX7XQ  B097R46CSY     5.0  1589665266052         NaN\n",
       "3  AFQLNQNQYFWQZPJQZS6V3NZU4QBQ  B08BZ63GMJ     5.0  1609322563534         NaN\n",
       "4  AGMJ3EMDVL6OWBJF7CA5RGJLXN5A  B00R8DXL44     4.0  1598567408138         NaN"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "'split: valid'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>parent_asin</th>\n",
       "      <th>rating</th>\n",
       "      <th>timestamp</th>\n",
       "      <th>history</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AFQLNQNQYFWQZPJQZS6V3NZU4QBQ</td>\n",
       "      <td>B09JS339BZ</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1643393630220</td>\n",
       "      <td>B08BZ63GMJ</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AHREXOGQPZDA6354MHH4ETSF3MCQ</td>\n",
       "      <td>B099DRHW5V</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1631885519443</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AEYORY2AVPMCPDV57CE337YU5LXA</td>\n",
       "      <td>B08BBQ29N5</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1634275259292</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AFETVW7S5M4LVJ7GTWPCKT7S3YBQ</td>\n",
       "      <td>B01M5KNSQN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1649634131604</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AGVVUU3QRQBHNASSGI5YQLPYOI2Q</td>\n",
       "      <td>B09FF97RHL</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1648824907536</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                        user_id parent_asin  rating      timestamp     history\n",
       "0  AFQLNQNQYFWQZPJQZS6V3NZU4QBQ  B09JS339BZ     1.0  1643393630220  B08BZ63GMJ\n",
       "1  AHREXOGQPZDA6354MHH4ETSF3MCQ  B099DRHW5V     5.0  1631885519443         NaN\n",
       "2  AEYORY2AVPMCPDV57CE337YU5LXA  B08BBQ29N5     3.0  1634275259292         NaN\n",
       "3  AFETVW7S5M4LVJ7GTWPCKT7S3YBQ  B01M5KNSQN     1.0  1649634131604         NaN\n",
       "4  AGVVUU3QRQBHNASSGI5YQLPYOI2Q  B09FF97RHL     1.0  1648824907536         NaN"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "'split: test'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>parent_asin</th>\n",
       "      <th>rating</th>\n",
       "      <th>timestamp</th>\n",
       "      <th>history</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AFZUK3MTBIBEDQOPAK3OATUOUKLA</td>\n",
       "      <td>B0BFR5WF1R</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1675826333052</td>\n",
       "      <td>B0020MKBNW B082FLP15V B00946HGLW</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AHV6QCNBJNSGLATP56JAWJ3C4G2A</td>\n",
       "      <td>B0B4JPGX8P</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1660417672640</td>\n",
       "      <td>B00N6WHTRG B00NNKWDI6 B00MDKICPK B010B0S67C B0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AHV6QCNBJNSGLATP56JAWJ3C4G2A</td>\n",
       "      <td>B0B4JP5YD9</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1660417831321</td>\n",
       "      <td>B00N6WHTRG B00NNKWDI6 B00MDKICPK B010B0S67C B0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AHV6QCNBJNSGLATP56JAWJ3C4G2A</td>\n",
       "      <td>B0B8DZ7H5F</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1663163956007</td>\n",
       "      <td>B00N6WHTRG B00NNKWDI6 B00MDKICPK B010B0S67C B0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AEZ26WGWJ3EOQ4KWSHG77HJAG4EA</td>\n",
       "      <td>B0B7RBK4NJ</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1662827578220</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                        user_id parent_asin  rating      timestamp  \\\n",
       "0  AFZUK3MTBIBEDQOPAK3OATUOUKLA  B0BFR5WF1R     1.0  1675826333052   \n",
       "1  AHV6QCNBJNSGLATP56JAWJ3C4G2A  B0B4JPGX8P     4.0  1660417672640   \n",
       "2  AHV6QCNBJNSGLATP56JAWJ3C4G2A  B0B4JP5YD9     5.0  1660417831321   \n",
       "3  AHV6QCNBJNSGLATP56JAWJ3C4G2A  B0B8DZ7H5F     4.0  1663163956007   \n",
       "4  AEZ26WGWJ3EOQ4KWSHG77HJAG4EA  B0B7RBK4NJ     1.0  1662827578220   \n",
       "\n",
       "                                             history  \n",
       "0                   B0020MKBNW B082FLP15V B00946HGLW  \n",
       "1  B00N6WHTRG B00NNKWDI6 B00MDKICPK B010B0S67C B0...  \n",
       "2  B00N6WHTRG B00NNKWDI6 B00MDKICPK B010B0S67C B0...  \n",
       "3  B00N6WHTRG B00NNKWDI6 B00MDKICPK B010B0S67C B0...  \n",
       "4                                                NaN  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "for split in ['train', 'valid', 'test']:\n",
    "    df = pd.read_csv(\n",
    "        file.format(split), \n",
    "    )\n",
    "    pprint(f\"split: {split}\")\n",
    "    pprint(df.head())"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "web",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.20"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
